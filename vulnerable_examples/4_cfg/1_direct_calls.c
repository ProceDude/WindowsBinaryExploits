#include <stdio.h>
#include <windows.h>

// so vsc doesn't spit out gcc errors
#ifndef _MSC_VER
#define __try
#define __except(expr) if(0)
#endif

// so vs won't complain
char * gets ( char * str );

void main1(void) {
	char buffer[32];
	puts("ciao");
	gets(buffer);
	puts(buffer);
}

int main(void) {
	char waste[1024] = "";
	waste[1023] = '\0';

	setvbuf(stdin, 0, _IONBF, 0);
	setvbuf(stdout, 0, _IONBF, 0);
	setvbuf(stderr, 0, _IONBF, 0);

	// leaking is not the point of this example, so free leak
	printf("Base address is %p\n", GetModuleHandleA(0));

	main1();

	puts(waste+1023);

	return 0;
}
