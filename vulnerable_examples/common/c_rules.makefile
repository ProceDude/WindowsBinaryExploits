
.PHONY: dummy_default_rule_21481248

dummy_default_rule_21481248:
	echo this makefile is meant to be included! (and maybe after a default rule definition)

# TODO link to script? or better location?
CL32 := ../common/remote_cl.sh 32
CL64 := ../common/remote_cl.sh 64
GCC32 := PATH=$$(echo $$PATH | sed s/mingw64/mingw32/) && gcc -m32
GCC64 := PATH=$$(echo $$PATH | sed s/mingw32/mingw64/) && gcc -m64
# for a more normal setup:
# CL32 := cl 2>&1 1>nul | grep -m 1 . | grep x86$ && cl
# CL64 := cl 2>&1 1>nul | grep -m 1 . | grep x64$ && cl

## dummy echo This is not a x86 dev console. Try executing "C:\Program Files (x86)\Microsoft Visual Studio\2022\BuildTools\VC\Auxiliary\Build\vcvars32.bat" && exit /B 1

FILTER_SPAM := grep -v '^[*][*]' | grep -viE '^(Microsoft|Copyright)' | grep -vi '^.vcvarsall' | grep -vi 'warning C4668'


%_gcc_64.exe: %.c
	$(GCC64) $(GCC_FLAGS) -o $@ $<

%_gcc_32.exe: %.c
	$(GCC32) $(GCC_FLAGS) -o $@ $<

# TODO more output filtering?
%_vs_64.exe: %.c
	$(CL64) $(VS_CFLAGS) /TC $< /link $(VS_LDFLAGS) /out:$@ 2>&1 | $(FILTER_SPAM)

%_vs_32.exe: %.c
	$(CL32) $(VS_CFLAGS) /TC $< /link $(VS_LDFLAGS) /out:$@ 2>&1 | $(FILTER_SPAM)
