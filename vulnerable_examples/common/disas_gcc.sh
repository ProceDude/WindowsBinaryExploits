#!/bin/sh

if [ $# -lt 2 ]; then
	echo "usage: $0 <exefile> <function>"
	exit
fi

FILE=$1
FUNC=$2

objdump -d -Mintel $FILE | grep -E "^[0-9a-f]+ <_?$FUNC>:" > /dev/null

if [ $? -ne 0 ]; then
	echo $FUNC not in $FILE
	exit
fi

objdump -d -Mintel $FILE | tr "\r\n" "^%" | sed -r "s/^.*\^%([0-9a-f]+ <_?$FUNC>:\^%)/\1/" | sed -r "s/(\^%[ \t]*\^%).*$/\1/" | tr "^%" "\r\n"
