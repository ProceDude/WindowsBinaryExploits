#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#include <windows.h>

const char pw[] = "v3ry_53cr37_p455wd";

// so vs won't complain
char * gets ( char * str );

struct {
	int a, b, c, d;
	char title[16];
	int theme, subtheme;
	float volume, brightness;
	int reserved[16];
} GlobalConfigs;

void loadConfig(void) {
	FILE * fp;
	fp = fopen("config.bin", "rb");
	if (!fp) {
		puts("Missing config");
		*((int*)0) = 0; // don't care
	}
	fread(&GlobalConfigs, 1, sizeof(GlobalConfigs), fp);
	fclose(fp);
}

int main(void) {
	setvbuf(stdin, 0, _IONBF, 0);
	setvbuf(stdout, 0, _IONBF, 0);
	setvbuf(stderr, 0, _IONBF, 0);

	loadConfig();

	char buffer[32];
	puts("Enter your name:");
	gets(buffer);
	printf("Hi, %s\nYour settings were found", buffer);

	return 0;
}

void dummy(void) {
	// manual gadgets insertion
	int dummy = 0x00c3e189; // mov ecx, esp; ret
	dummy = dummy; // to remove annoying warnings

	VirtualAlloc(0, 1, MEM_RESERVE, PAGE_READWRITE);
	ExitProcess(0);
}
